<!-- templates/results.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>FIR DSP — Results</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <style>
    /* Layout */
    .plots-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .plot-card {
      background: #0b1622;
      border-radius: 10px;
      padding: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
      text-align: center;
    }

    .plot-card img {
      max-width: 100%;
      height: auto;
      border-radius: 6px;
      cursor: zoom-in;
      transition: transform 0.2s;
    }

    .plot-card img:hover {
      transform: scale(1.02);
    }

    .plot-card figcaption {
      margin-top: 6px;
      font-size: 0.9rem;
      color: #ccc;
    }

    /* Modal overlay */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      overflow: auto;
      align-items: center;
      justify-content: center;
    }

    .modal img {
      max-width: 95%;
      max-height: 90%;
      margin: auto;
      display: block;
      cursor: zoom-out;
    }
  </style>
</head>
<body>
  <header class="hero">
    <h1>FIR DSP — Results</h1>
  </header>

  <main class="card">
    <h2>Simulation Summary</h2>
    <p>
      Sampling: {{ results.fs }} Hz |
      Filter: {{ results.ftype }} ({{ results.numtaps }} taps) |
      Ripple: {{ results.ripple }} dB |
      Stop Att: {{ results.attenuation }} dB |
      Sine freqs: {{ results.sine_freqs }} |
      RMSE vs Verilog: {{ "%.4e"|format(results.rmse) }}
    </p>

    <h2>Plots</h2>
    <div class="plots-grid">
      {% set captions = {
        "sine_input_plot_zoomed.png": "Input Sine Signal (Zoomed)",
        "filter_response.png": "Designed FIR Filter Response",
        "filter_out_time_verilog.png": "Verilog Output (Time Domain)",
        "filter_out_fft_verilog.png": "Verilog Output (Frequency Domain)",
        "ideal_response_time.png": "Ideal Python Output (Time Domain)",
        "ideal_response_fft.png": "Ideal Python Output (Frequency Domain)",
        "comparison_time.png": "Comparison: Ideal vs Verilog (Time)",
        "comparison_fft.png": "Comparison: Ideal vs Verilog (Frequency)"
      } %}
      {% for plot, caption in captions.items() %}
      <figure class="plot-card">
        <a href="#modal" onclick="showModal('{{ plots_dir }}/{{ plot }}')">
          <img src="{{ plots_dir }}/{{ plot }}" alt="{{ caption }}">
        </a>
        <figcaption>{{ caption }}</figcaption>
      </figure>
      {% endfor %}
    </div>
  </main>

  <!-- Modal -->
  <div id="modal" class="modal" onclick="hideModal()">
    <img id="modal-img" src="" alt="enlarged plot">
  </div>

<script>
function showModal(src) {
  const modal = document.getElementById('modal');
  const img = document.getElementById('modal-img');
  img.src = src;
  modal.style.display = "flex";
}
function hideModal() {
  document.getElementById('modal').style.display = "none";
}
</script>
</body>
</html>

